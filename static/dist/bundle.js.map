{"version":3,"file":"bundle.js","sources":["../js/db.js","../js/hooks.js","../js/toolbar.js","../js/utils.js","../js/floatButton.js","../js/viewportController.js","../js/ndModal.plugin.js","../js/index.js"],"sourcesContent":["export default {\n  lastCaretPos: 0,\n  keyboardOpen: false,\n  autoHideToolbar: false,\n};\n","import db from './db';\n\n/** Helper */\n// TODO: refactor needed\nconst isChildOf = (node, parentId) => {\n  while (node != null) {\n    if (node.id === parentId) {\n      return true;\n    }\n    node = node.parentNode;\n  }\n\n  return false;\n};\n\nconst getCurrentCursorPosition = (parentId) => {\n  const selection = $(document).find('iframe[name=\"ace_outer\"]')\n      .contents().find('iframe[name=\"ace_inner\"]').contents()[0].getSelection();\n  let charCount = -1;\n  let node;\n\n  if (selection.focusNode) {\n    if (isChildOf(selection.focusNode, parentId)) {\n      node = selection.focusNode;\n      charCount = selection.focusOffset;\n\n      while (node) {\n        if (node.id === parentId) {\n          break;\n        }\n\n        if (node.previousSibling) {\n          node = node.previousSibling;\n          charCount += node.textContent.length;\n        } else {\n          node = node.parentNode;\n          if (node == null) {\n            break;\n          }\n        }\n      }\n    }\n  }\n\n  return charCount;\n};\n\n/** Hooks */\nexport const aceEditorCSS = () => {\n  if (!clientVars.userAgent.isMobile) return [];\n  return ['ep_mobile_view/static/css/innerMobile.css'];\n};\n\nexport const aceEditEvent = (hookName, call) => {\n  // If it's not a click or a key event and the text hasn't changed then do nothing\n  const cs = call.callstack;\n\n  // save last postion of the caret\n  // TODO: refactor needed\n  if ((cs.type === 'handleKeyEvent')) {\n    setTimeout(() => {\n      db.lastCaretPos = getCurrentCursorPosition('innerdocbody');\n    }, 200);\n  }\n\n  if (!(cs.type === 'handleClick') && !(cs.type === 'handleKeyEvent') && !(cs.docTextChanged)) {\n    return false;\n  }\n  // If it's an initial setup event then do nothing..\n  if (cs.type === 'setBaseText' || cs.type === 'setup') return false;\n\n  // toolbar caret attr check\n  setTimeout(() => {\n    const attributeManager = call.documentAttributeManager;\n    $('#mobileToolbar > ul > li').removeClass('active');\n\n    for (const caretAttr of ['bold', 'italic', 'underline']) {\n      const activeCaret = attributeManager.hasAttributeOnSelectionOrCaretPosition(caretAttr);\n      if (activeCaret) {\n        $(`#mobileToolbar > ul > li[data-action=\"${caretAttr}\"]`).addClass('active');\n      }\n    }\n  }, 250);\n\n  return {};\n};\n","const commands = {};\n\nclass ToolbarItem {\n  constructor(element) {\n    this.$el = element;\n  }\n\n  getCommand() {\n    return this.$el.attr('data-action');\n  }\n\n  getValue() {\n    if (this.isSelect()) {\n      return this.$el.find('select').val();\n    }\n  }\n\n  setValue(val) {\n    if (this.isSelect()) {\n      return this.$el.find('select').val(val);\n    }\n  }\n\n  getType() {\n    return this.$el.attr('data-type');\n  }\n\n  isSelect() {\n    return this.getType() === 'select';\n  }\n\n  isButton() {\n    return this.getType() === 'button';\n  }\n\n  bind(callback) {\n    if (this.isButton()) {\n      this.$el.on('click touchstart', (event) => {\n        $(':focus').blur();\n        callback(this.getCommand(), this);\n        event.preventDefault();\n      });\n    } else if (this.isSelect()) {\n      this.$el.find('select').change(() => {\n        callback(this.getCommand(), this);\n      });\n    }\n  }\n}\n\nexport default (context) => {\n  const triggerCommand = (cmd, item) => {\n    if (commands[cmd]) {\n      commands[cmd](cmd, context.ace, item);\n    }\n    if (context.ace) context.ace.focus();\n  };\n\n  const preventTouchElemets = '#mobileToolbar, #headings, .buttonicon-undo, .buttonicon-redo';\n  // prevent close keyboard\n  $(document).on('touchend touchstart', preventTouchElemets, (e) => {\n    e.preventDefault();\n  });\n\n  $('#mobileToolbar [data-action], #menu_editeMode [data-action]').each((i, elt) => {\n    $(elt).unbind('click');\n    new ToolbarItem($(elt)).bind((command, item) => {\n      triggerCommand(command, item);\n    });\n  });\n\n  const registerCommand = (cmd, callback) => {\n    commands[cmd] = callback;\n  };\n\n  const registerAceCommand = (cmd, callback) => {\n    registerCommand(cmd, (cmd, ace, item) => {\n      ace.callWithAce((ace) => {\n        callback(cmd, ace, item);\n      }, cmd, true);\n    });\n  };\n\n  const aceAttributeCommand = (cmd, ace) => {\n    ace.ace_toggleAttributeOnSelection(cmd);\n  };\n\n  // register tooblar buttons\n  registerAceCommand('bold', aceAttributeCommand);\n  registerAceCommand('italic', aceAttributeCommand);\n  registerAceCommand('underline', aceAttributeCommand);\n  registerAceCommand('insertunorderedlist', (cmd, ace) => {\n    ace.ace_doInsertUnorderedList();\n  });\n  registerAceCommand('insertorderedlist', (cmd, ace) => {\n    ace.ace_doInsertOrderedList();\n  });\n  registerAceCommand('undo', (cmd, ace) => ace.ace_doUndoRedo(cmd));\n  registerAceCommand('redo', (cmd, ace) => ace.ace_doUndoRedo(cmd));\n};\n","export const $outerBody = () => $('iframe[name=\"ace_outer\"]').contents().find('body');\n","import db from './db';\nimport {$outerBody} from './utils';\n\n\n// TODO: refactor needed\nconst createRange = (node, chars, range) => {\n  if (!range) {\n    range = document.createRange();\n    range.selectNode(node);\n    range.setStart(node, 0);\n  }\n\n  if (chars.count === 0) {\n    range.setEnd(node, chars.count);\n  } else if (node && chars.count > 0) {\n    if (node.nodeType === Node.TEXT_NODE) {\n      if (node.textContent.length < chars.count) {\n        chars.count -= node.textContent.length;\n      } else {\n        range.setEnd(node, chars.count);\n        chars.count = 0;\n      }\n    } else {\n      for (let lp = 0; lp < node.childNodes.length; lp++) {\n        range = createRange(node.childNodes[lp], chars, range);\n\n        if (chars.count === 0) {\n          break;\n        }\n      }\n    }\n  }\n\n  return range;\n};\n\n\nconst setCurrentCursorPosition = (chars) => {\n  if (chars >= 0) {\n    const selection = window.getSelection();\n    const innerdoc = $(document).find('iframe[name=\"ace_outer\"]')\n        .contents()\n        .find('iframe[name=\"ace_inner\"]')\n        .contents()\n        .find('#innerdocbody')[0];\n\n    const range = createRange(innerdoc, {count: chars});\n\n    if (range) {\n      range.collapse(false);\n      selection.removeAllRanges();\n      selection.addRange(range);\n    }\n  }\n};\n\n\nexport default (context) => {\n  const fButton = `\n    <div class=\"floatingButton\">\n      <button>\n        <span class=\"icon pencil\"></span>\n      </button>\n    </div>\n  `;\n\n  $outerBody().append(fButton);\n\n  $outerBody().on('click touchstart', '.floatingButton button', () => {\n    setCurrentCursorPosition(db.lastCaretPos);\n    // put the contents in to the editable mode\n    context.ace.callWithAce((ace) => {\n      ace.ace_setEditable(true);\n      // if the device is Android\n      if (!clientVars.userAgent.isSafari) {\n        $(document).find('iframe[name=\"ace_outer\"]')\n            .contents().find('iframe[name=\"ace_inner\"]')\n            .contents().find('#innerdocbody')[0].focus();\n      }\n    }, 'contentEditable', true);\n\n    $outerBody().find('.floatingButton').fadeOut('fast');\n    $('#mobileToolbar').show();\n\n    $('body.mobileView header .title, #openLeftSideMenue')\n        .hide(0, () => {\n          $('#menu_editeMode').css({display: 'flex'});\n        });\n  });\n};\n","import db from './db';\nimport {$outerBody} from './utils';\n\nconst viewPortHeight = window.innerHeight;\nlet touchStartPosX = 0;\n\nconst innderDoc = () => $(document)\n    .find('iframe[name=\"ace_outer\"]')\n    .contents().find('iframe[name=\"ace_inner\"]').contents();\n\nexport default (context) => {\n  const scrollDown = () => {\n    if (!db.keyboardOpen) {\n      $('#mainHeader').css({\n        transform: 'translateY(-100%)',\n      });\n    }\n\n    $outerBody().find('.floatingButton').css({\n      transform: 'translateY(160%)',\n    });\n  };\n\n  const scrollUp = () => {\n    $('#mainHeader').css({\n      transform: 'translateY(0)',\n    });\n    $outerBody().find('.floatingButton').css({\n      transform: 'translateY(0)',\n    });\n  };\n\n  // Detect Scroll Down and Up in mobile(android|ios)\n  innderDoc().on('touchmove', (e) => {\n    if (!db.autoHideToolbar) return;\n    // Different devices give different values with different decimal percentages.\n    const currentPageX = Math.round(e.originalEvent.touches[0].screenY);\n\n    if (currentPageX <= 60) return false;\n    if (touchStartPosX === currentPageX) return false;\n\n    if (touchStartPosX - currentPageX > 0) {\n      // console.log('down');\n      scrollDown();\n    } else {\n      // console.log('up');\n      scrollUp();\n    }\n    touchStartPosX = currentPageX;\n  });\n\n  const onKeyboardOnOff = (isOpen, viewportHeight, pageTop) => {\n    // Write down your handling code\n    viewportHeight = Math.trunc(viewportHeight + pageTop);\n    if (isOpen) {\n      // keyboard is open\n      $('#mobileToolbar, #menu_editeMode').css('display', 'flex');\n      $('#openLeftSideMenue').hide();\n      $outerBody().find('.floatingButton').fadeOut('fast');\n      db.keyboardOpen = true;\n    } else {\n      // keyboard is closed\n      $('#mobileToolbar, #menu_editeMode').hide();\n      $('#openLeftSideMenue, body.mobileView header .title').show();\n      $outerBody().find('.floatingButton').fadeIn('fast');\n      // put the contents in to the readOnly mode\n      context.ace.callWithAce((ace) => {\n        ace.ace_setEditable(false);\n      }, 'contentEditable', true);\n      db.keyboardOpen = false;\n      // ios close keyboard\n      $(document).find('iframe[name=\"ace_outer\"]')\n          .contents().find('iframe[name=\"ace_inner\"]')\n          .contents()[0].activeElement.blur();\n\n      // navigator.virtualKeyboard.hide();\n    }\n\n    $('html.pad, html.pad body').css({\n      height: `${viewportHeight}px`,\n    });\n  };\n\n  const scrollToFixViewPort = (viewport) => {\n    const selection = $(document).find('iframe[name=\"ace_outer\"]')\n        .contents().find('iframe[name=\"ace_inner\"]').contents()[0].getSelection();\n\n    const targetNode = selection.anchorNode.parentElement.closest('div');\n\n    if (!targetNode) return;\n\n    const $outerdoc = $('iframe[name=\"ace_outer\"]').contents().find('#outerdocbody');\n    const $outerdocHTML = $outerdoc.parent();\n    const mainHeder = $('#mainHeader').innerHeight();\n    const offsetTop = targetNode.offsetTop - mainHeder - 25;\n    $outerdocHTML.animate({scrollTop: offsetTop});\n  };\n\n  const viewportHandler = (event) => {\n    event.preventDefault();\n    const viewport = event.target;\n    if (viewport.height < viewPortHeight) {\n      onKeyboardOnOff(true, viewport.height, viewport.pageTop);\n      scrollToFixViewPort(viewport);\n    } else {\n      // console.log(\"keyboard closed\")\n      onKeyboardOnOff(false, viewport.height, viewport.pageTop);\n    }\n  };\n\n  window.visualViewport.addEventListener('resize', viewportHandler);\n  window.visualViewport.addEventListener('scroll', viewportHandler);\n\n  $(document).on('click touchstart', '#closeVirtualKeyboar', (event) => {\n    $('#menu_editeMode').hide(0, () => {\n      $('body.mobileView header .title, #openLeftSideMenue').show();\n      viewportHandler(event);\n    });\n  });\n};\n","$.fn.ndModal = function () {\n  if ($(this).find('.blackScreen').length === 0) {\n    this.append('<div class=\"blackScreen\"></div>');\n  }\n\n  const closeModal = (el) => {\n    $(el).addClass('close');\n    setTimeout(() => {\n      $(el).removeClass('active close');\n    }, 600);\n  };\n\n  $(this).on('click touchstart', '.btnCloseNdModal', (e) => {\n    closeModal(this);\n  });\n\n  const closeBtn = `\n      <button class=\"btnCloseNdModal\">\n        <span class=\"icon close\">\n          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"28\" height=\"28\" viewBox=\"0 0 24 24\" fill=\"none\">\n            <path d=\"M6.75 17.25L17.25 6.75\" stroke=\"#333333\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n            <path d=\"M17.25 17.25L6.75 6.75\" stroke=\"#333333\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n          </svg>\n        </span>\n      </button>\n    `;\n\n  if ($(this).find('.btnCloseNdModal').length === 0) {\n    $(this).find('.menue').prepend(closeBtn);\n  }\n\n  // if click to the balck screen close the modal\n  $(this).on('click touchstart', (e) => {\n    const isBlackScreen = $(e.target).hasClass('blackScreen');\n    const isWrapperActive = $(this).hasClass('active');\n    if (isBlackScreen && isWrapperActive) {\n      closeModal(this);\n    }\n  });\n\n  // I do not want the black screen event to be activated immediately.\n  setTimeout(() => {\n    $(this).addClass('active');\n  }, 200);\n\n  return this;\n};\n","import {aceEditorCSS as aceCss, aceEditEvent as aceEvents} from './hooks';\nimport toolbar from './toolbar';\nimport floatButton from './floatButton';\nimport viewportController from './viewportController';\nimport './ndModal.plugin';\n\nexport const aceEditorCSS = aceCss;\nexport const aceEditEvent = aceEvents;\n\nexport const postAceInit = (hookName, context) => {\n  if (!clientVars.userAgent.isMobile) return false;\n\n  // put the contents in to the readOnly mode\n  context.ace.callWithAce((ace) => {\n    ace.ace_setEditable(false);\n  }, 'disableContentEditable', true);\n\n  $(document).on('touchstart', '#openLeftSideMenue', () => {\n    $('#tableOfContentsModal').ndModal();\n  });\n\n  $(document).on('touchstart', '#mainHeader #pad_title .padName, body > header .shortMenue .btnChat', (e) => {\n    e.stopPropagation();\n    e.preventDefault();\n    $('.ndModal.active').each(function () {\n      $(this).removeClass('active');\n    });\n    // open chat modal\n    $('#chatModal')\n        .ndModal()\n        .find('.btnCloseNdModal')\n        .attr({id: 'header_chat_room_close'});\n    setTimeout(() => {\n      const headerCounter = $(document).find('#headerContainer');\n      $('#chatModal .header .title').html(headerCounter.text());\n      headerCounter.trigger('click');\n    }, 400);\n  });\n\n  viewportController(context);\n  toolbar(context);\n  floatButton(context);\n};\n\nexport const collectContentPre = (hookName, context) => {\n  const tname = context.tname;\n  if ('i, b, u'.includes(tname)) {\n    context.state.author = clientVars.author = clientVars.userId;\n  }\n  return [];\n};\n"],"names":["db","lastCaretPos","keyboardOpen","autoHideToolbar","commands","ToolbarItem","constructor","element","this","$el","getCommand","attr","getValue","isSelect","find","val","setValue","getType","isButton","bind","callback","on","event","$","blur","preventDefault","change","toolbar","context","document","e","each","i","elt","unbind","command","item","cmd","ace","focus","triggerCommand","registerAceCommand","registerCommand","callWithAce","aceAttributeCommand","ace_toggleAttributeOnSelection","ace_doInsertUnorderedList","ace_doInsertOrderedList","ace_doUndoRedo","$outerBody","contents","createRange","node","chars","range","selectNode","setStart","count","setEnd","nodeType","Node","TEXT_NODE","textContent","length","lp","childNodes","floatButton","append","selection","window","getSelection","innerdoc","collapse","removeAllRanges","addRange","setCurrentCursorPosition","ace_setEditable","clientVars","userAgent","isSafari","fadeOut","show","hide","css","display","viewPortHeight","innerHeight","viewportController","onKeyboardOnOff","isOpen","viewportHeight","pageTop","Math","trunc","fadeIn","activeElement","height","viewportHandler","viewport","target","targetNode","anchorNode","parentElement","closest","$outerdocHTML","parent","mainHeder","offsetTop","animate","scrollTop","scrollToFixViewPort","visualViewport","addEventListener","fn","ndModal","closeModal","el","addClass","setTimeout","removeClass","prepend","isBlackScreen","hasClass","isWrapperActive","aceEditorCSS","isMobile","aceEditEvent","hookName","call","cs","callstack","type","parentId","charCount","focusNode","id","parentNode","isChildOf","focusOffset","previousSibling","getCurrentCursorPosition","attributeManager","documentAttributeManager","caretAttr","hasAttributeOnSelectionOrCaretPosition","exports","collectContentPre","tname","includes","state","author","userId","postAceInit","stopPropagation","headerCounter","html","text","trigger"],"mappings":"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"}